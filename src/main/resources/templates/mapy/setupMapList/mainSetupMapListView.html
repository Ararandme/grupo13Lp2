<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>Config Anaqueles</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-3">

<div class="container">
    <header th:insert="~{template/header :: header}"></header>

    <!-- 1) GET form:  warehouse list -->
<div th:replace="~{/mapy/setupMapList/_selectWarehouseList :: selectWarehouseList}"></div>

    <!-- 2) POST form: list of naves -->
    <form th:if="${form.warehouseId != null and form.warehouseId > 0}"
          th:object="${form}"
          th:action="@{/mapy/setupMapList/saveAnaquel}"
          method="post"
          class="p-3 border rounded">

        <input type="hidden" th:field="*{warehouseId}"/>

        <div class="mb-3">
            <h5 class="mb-0">Asignar configuraciones por Nave</h5>
        </div>

        <div class="table-responsive">
            <table class="table table-sm table-bordered align-middle">
                <thead class="table-light">
                <tr>
                    <th style="width: 80px;">Usar</th>
                    <th>Nave</th>
                    <th>Config Superior</th>
                    <th>Config Frontal</th>
                </tr>
                </thead>

                <tbody>
                <tr th:each="a, stat : *{anaqueles}">
                    <!-- checkbox -->
                    <td class="text-center">
                        <input class="form-check-input" type="checkbox" th:field="*{anaqueles[__${stat.index}__].selected}">
                    </td>

                    <!-- nave id hidden + show label -->
                    <td>
                        <input type="hidden" th:field="*{anaqueles[__${stat.index}__].naveId}">
                        <span th:text="'Nave ID: ' + *{anaqueles[__${stat.index}__].naveId}"></span>
                        <!-- if you also want nave name, you can add it to DTO -->
                    </td>

                    <!-- superior select -->
                    <td>
                        <select class="form-select form-select-sm"
                                th:field="*{anaqueles[__${stat.index}__].superiorConfigId}">
                            <option value="0">-- seleccionar --</option>
                            <option th:each="c : ${configSuperiors}"
                                    th:value="${c.id}"
                                    th:text="${c.configNombre}">
                            </option>
                        </select>
                    </td>

                    <!-- frontal select -->
                    <td>
                        <select class="form-select form-select-sm"
                                th:field="*{anaqueles[__${stat.index}__].frontalConfigId}">
                            <option value="0">-- seleccionar --</option>
                            <option th:each="c : ${configFrontals}"
                                    th:value="${c.id}"
                                    th:text="${c.configNombre}">
                            </option>
                        </select>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <button type="submit" class="btn btn-success">Guardar Asignaci√≥n</button>
    </form>

</div>
</body>
</html>
